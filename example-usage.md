# MCP Server 使用示例

## 启动服务器

```bash
# 方法1: 使用启动脚本
./start.sh

# 方法2: 直接使用npm
npm start

# 方法3: 开发模式（自动重启）
npm run dev
```

## 工具调用示例

### 1. 查询订单信息

**请求示例：**
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "query_order",
    "arguments": {
      "phone": "17798762697"
    }
  }
}
```

**响应示例：**
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "找到 1 个订单：\n\n订单 1:\n  手机号: 17798762697\n  订单号: PO202508281731220218\n  租借位置: 北京后海-166分店\n  租借状态: 已暂停\n  是否允许停止计费: 否\n  设备ID: D20219\n  租借开始时间: 2025-08-28 20:35:00\n  持续时间: 32分钟\n  计费: ¥3.2\n  支付方式: 微信支付"
      }
    ]
  }
}
```

### 2. 查询附近网点

**请求示例：**
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "tools/call",
  "params": {
    "name": "query_stores",
    "arguments": {
      "latitude": 39.946613,
      "longitude": 116.370503,
      "limit": 3
    }
  }
}
```

**响应示例：**
```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "找到 3 个附近网点：\n\n网点 1:\n  网点名称: 北京后海-110分店\n  状态: 正常\n  经纬度: 116.3705,39.94661\n  详细地址: 北京市西城区羊房胡同甲23号\n  距离: 0.00公里\n  营业时间: 9:00-22:00\n  评分: 4.5\n  联系电话: 15858905939\n  门店类型: 直营店\n\n网点 2:\n  网点名称: 北京后海-125分店\n  状态: 正常\n  经纬度: 116.3744,39.94219\n  详细地址: 北京市西城区羊房胡同甲31号\n  距离: 0.59公里\n  营业时间: 9:00-22:00\n  评分: 4.7\n  联系电话: 15828386811\n  门店类型: 直营店\n\n网点 3:\n  网点名称: 北京后海-148分店\n  状态: 正常\n  经纬度: 116.3692,39.94074\n  详细地址: 北京市西城区后海北沿70号\n  距离: 0.66公里\n  营业时间: 9:00-22:00\n  评分: 4.8\n  联系电话: 15817929741\n  门店类型: 直营店"
      }
    ]
  }
}
```

## 与AI智能客服系统集成

### 腾讯智能体开放平台ADP集成

1. 将MCP Server部署到服务器
2. 在ADP平台配置MCP Server地址
3. 配置工具调用权限
4. 测试工具调用功能

### 配置示例

```json
{
  "mcpServers": {
    "ai-customer-service": {
      "command": "node",
      "args": ["src/server.js"],
      "cwd": "/path/to/mcp_test",
      "env": {
        "NODE_ENV": "production"
      }
    }
  }
}
```

## 错误处理

### 常见错误及解决方案

1. **手机号格式错误**
   - 错误: "手机号格式不正确"
   - 解决: 确保手机号为11位数字，以1开头

2. **经纬度范围错误**
   - 错误: "纬度必须在-90到90之间"
   - 解决: 检查经纬度值是否在有效范围内

3. **数据未找到**
   - 错误: "未找到手机号对应的订单信息"
   - 解决: 确认手机号在系统中存在

## 性能优化建议

1. **数据缓存**: 对于频繁查询的数据，建议添加缓存机制
2. **数据库连接池**: 如果使用数据库，配置连接池提高性能
3. **负载均衡**: 高并发场景下使用负载均衡器
4. **监控告警**: 添加系统监控和告警机制

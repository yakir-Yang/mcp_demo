# æ•°æ®æ›´æ–°æŒ‡å—

## ğŸ“Š æ•°æ®æ–‡ä»¶è¯´æ˜

### å½“å‰é…ç½®
- **é—¨åº—æ•°æ®**: `data/stores.xlsx`
- **è®¢å•æ•°æ®**: `data/orders.xlsx`
- **æ•°æ®æ ¼å¼**: Excel (.xlsx) æ–‡ä»¶
- **åŠ è½½æ–¹å¼**: è‡ªåŠ¨ä»Excelæ–‡ä»¶åŠ è½½ï¼Œå¤±è´¥æ—¶ä½¿ç”¨ç¤ºä¾‹æ•°æ®

### æ•°æ®æ–‡ä»¶ç»“æ„

#### é—¨åº—æ•°æ® (stores.xlsx)
| åˆ—å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| ç½‘ç‚¹åç§° | string | é—¨åº—åç§° | åŒ—äº¬åæµ·-110åˆ†åº— |
| çŠ¶æ€ | string | è¥ä¸šçŠ¶æ€ | æ­£å¸¸ |
| ç»çº¬åº¦ | string | åæ ‡ä¿¡æ¯ | 116.370503,39.946613 |
| çœä»½ | string | æ‰€å±çœä»½ | åŒ—äº¬å¸‚ |
| åŸå¸‚ | string | æ‰€å±åŸå¸‚ | åŒ—äº¬å¸‚ |
| åŒº/å¿ | string | æ‰€å±åŒºå¿ | è¥¿åŸåŒº |
| è¯¦ç»†åœ°å€ | string | å…·ä½“åœ°å€ | åŒ—äº¬å¸‚è¥¿åŸåŒºç¾Šæˆ¿èƒ¡åŒç”²23å· |
| ç»åº¦ | number | ç»åº¦å€¼ | 116.3705 |
| çº¬åº¦ | number | çº¬åº¦å€¼ | 39.94661 |
| é—¨åº—ç±»å‹ | string | é—¨åº—ç±»å‹ | ç›´è¥åº— |
| å¼€ä¸šæ—¶é—´ | string | å¼€ä¸šæ—¥æœŸ | 2024/3/1 |
| è¥ä¸šæ—¶é—´ | string | è¥ä¸šæ—¶é—´æ®µ | 9:00-22:00 |
| è¯„åˆ† | number | é—¨åº—è¯„åˆ† | 4.5 |
| è”ç³»ç”µè¯ | string | è”ç³»ç”µè¯ | 15858905939 |

#### è®¢å•æ•°æ® (orders.xlsx)
| åˆ—å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| è®¢å•å· | string | å”¯ä¸€è®¢å•æ ‡è¯† | PO202508281731220218 |
| ç”¨æˆ·id | string | ç”¨æˆ·æ ‡è¯† | U10058 |
| æ‰‹æœºå· | string | ç”¨æˆ·æ‰‹æœºå· | 17798762697 |
| è®¾å¤‡id | string | è®¾å¤‡æ ‡è¯† | D20219 |
| ç§Ÿå€Ÿä½ç½® | string | ç§Ÿå€Ÿé—¨åº— | åŒ—äº¬åæµ·-166åˆ†åº— |
| ç§Ÿå€Ÿå¼€å§‹æ—¶é—´ | string | å¼€å§‹æ—¶é—´ | 2025-08-28 20:35:00 |
| é€€è¿˜æ—¶é—´ | string | é€€è¿˜æ—¶é—´ | (ç©º) |
| æŒç»­æ—¶é—´/åˆ†é’Ÿ | number | ä½¿ç”¨æ—¶é•¿ | 32 |
| å½’è¿˜ç½‘ç‚¹ | string | å½’è¿˜é—¨åº— | (ç©º) |
| è®¡è´¹ | number | è´¹ç”¨é‡‘é¢ | 3.2 |
| ç§Ÿå€ŸçŠ¶æ€ | string | è®¢å•çŠ¶æ€ | å·²æš‚åœ |
| æ”¯ä»˜æ–¹å¼ | string | æ”¯ä»˜æ–¹å¼ | wechat_pay |

## ğŸ”„ æ•°æ®æ›´æ–°æµç¨‹

### æ–¹æ³•1: ç›´æ¥æ›´æ–°Excelæ–‡ä»¶ï¼ˆæ¨èï¼‰

1. **ç¼–è¾‘Excelæ–‡ä»¶**
   ```bash
   # åœ¨æœ¬åœ°ç¼–è¾‘Excelæ–‡ä»¶
   # ä½¿ç”¨Excelã€WPSæˆ–å…¶ä»–ç”µå­è¡¨æ ¼è½¯ä»¶
   ```

2. **ä¸Šä¼ åˆ°CVM**
   ```bash
   # ä¸Šä¼ æ›´æ–°åçš„æ–‡ä»¶åˆ°CVM
   scp data/stores.xlsx ubuntu@106.53.191.184:~/mcp_demo/data/
   scp data/orders.xlsx ubuntu@106.53.191.184:~/mcp_demo/data/
   ```

3. **é‡å¯æœåŠ¡**
   ```bash
   # ç™»å½•CVM
   ssh ubuntu@106.53.191.184
   
   # è¿›å…¥é¡¹ç›®ç›®å½•
   cd ~/mcp_demo
   
   # é‡å¯æœåŠ¡
   pm2 restart mcp-http-server
   
   # æˆ–è€…å¦‚æœä½¿ç”¨npm start
   pkill -f "node src/http-server.js"
   npm start
   ```

### æ–¹æ³•2: ä½¿ç”¨æ•°æ®åŒæ­¥è„šæœ¬

åˆ›å»ºä¸€ä¸ªæ•°æ®åŒæ­¥è„šæœ¬ï¼š

```bash
#!/bin/bash
# sync-data.sh

echo "åŒæ­¥æ•°æ®æ–‡ä»¶åˆ°CVM..."

# ä¸Šä¼ æ–‡ä»¶
scp data/stores.xlsx ubuntu@106.53.191.184:~/mcp_demo/data/
scp data/orders.xlsx ubuntu@106.53.191.184:~/mcp_demo/data/

# é‡å¯æœåŠ¡
ssh ubuntu@106.53.191.184 "cd ~/mcp_demo && pm2 restart mcp-http-server"

echo "æ•°æ®åŒæ­¥å®Œæˆï¼"
```

## ğŸ§ª éªŒè¯æ•°æ®æ›´æ–°

### 1. æ£€æŸ¥æ•°æ®åŠ è½½æ—¥å¿—
```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
pm2 logs mcp-http-server

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# ä»Excelæ–‡ä»¶åŠ è½½é—¨åº—æ•°æ®: X ä¸ªé—¨åº—
# ä»Excelæ–‡ä»¶åŠ è½½è®¢å•æ•°æ®: Y ä¸ªè®¢å•
```

### 2. æµ‹è¯•æ•°æ®æŸ¥è¯¢
```bash
# æµ‹è¯•è®¢å•æŸ¥è¯¢
curl -X POST http://106.53.191.184:3000/tools/call \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "query_order",
      "arguments": {
        "phone": "æ‚¨çš„æµ‹è¯•æ‰‹æœºå·"
      }
    }
  }'

# æµ‹è¯•ç½‘ç‚¹æŸ¥è¯¢
curl -X POST http://106.53.191.184:3000/tools/call \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 2,
    "method": "tools/call",
    "params": {
      "name": "query_stores",
      "arguments": {
        "latitude": 39.946613,
        "longitude": 116.370503,
        "limit": 5
      }
    }
  }'
```

### 3. è¿è¡Œå®Œæ•´æµ‹è¯•
```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
./test-http-server.sh
```

## ğŸ“‹ æ•°æ®æ ¼å¼è¦æ±‚

### Excelæ–‡ä»¶è¦æ±‚
1. **æ–‡ä»¶æ ¼å¼**: .xlsx (Excel 2007+)
2. **ç¼–ç **: UTF-8
3. **ç¬¬ä¸€è¡Œ**: å¿…é¡»åŒ…å«åˆ—æ ‡é¢˜
4. **æ•°æ®è¡Œ**: ä»ç¬¬äºŒè¡Œå¼€å§‹

### æ•°æ®éªŒè¯è§„åˆ™

#### é—¨åº—æ•°æ®éªŒè¯
- ç½‘ç‚¹åç§°: ä¸èƒ½ä¸ºç©º
- ç»åº¦: å¿…é¡»åœ¨-180åˆ°180ä¹‹é—´
- çº¬åº¦: å¿…é¡»åœ¨-90åˆ°90ä¹‹é—´
- è¯„åˆ†: å¿…é¡»åœ¨0åˆ°5ä¹‹é—´
- è”ç³»ç”µè¯: å¿…é¡»æ˜¯æœ‰æ•ˆçš„æ‰‹æœºå·æ ¼å¼

#### è®¢å•æ•°æ®éªŒè¯
- è®¢å•å·: ä¸èƒ½ä¸ºç©ºï¼Œå¿…é¡»å”¯ä¸€
- æ‰‹æœºå·: å¿…é¡»æ˜¯11ä½æ•°å­—ï¼Œä»¥1å¼€å¤´
- è®¡è´¹: å¿…é¡»æ˜¯éè´Ÿæ•°
- ç§Ÿå€ŸçŠ¶æ€: å¿…é¡»æ˜¯æœ‰æ•ˆçŠ¶æ€ï¼ˆè¿›è¡Œä¸­ã€å·²æš‚åœã€å·²å®Œæˆç­‰ï¼‰

## ğŸš¨ å¸¸è§é—®é¢˜

### 1. æ•°æ®åŠ è½½å¤±è´¥
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la data/

# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la data/*.xlsx

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs mcp-http-server
```

### 2. æ•°æ®æ ¼å¼é”™è¯¯
```bash
# æ£€æŸ¥Excelæ–‡ä»¶æ ¼å¼
file data/stores.xlsx
file data/orders.xlsx

# éªŒè¯æ•°æ®å†…å®¹
head -5 data/stores.xlsx
head -5 data/orders.xlsx
```

### 3. æœåŠ¡é‡å¯å¤±è´¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
pm2 logs mcp-http-server --lines 50

# æ‰‹åŠ¨é‡å¯
pm2 stop mcp-http-server
pm2 start src/http-server.js --name mcp-http-server
```

## ğŸ”§ æ•°æ®ç®¡ç†å·¥å…·

### åˆ›å»ºæ•°æ®å¤‡ä»½
```bash
#!/bin/bash
# backup-data.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="backups/$DATE"

mkdir -p $BACKUP_DIR
cp data/*.xlsx $BACKUP_DIR/

echo "æ•°æ®å¤‡ä»½å®Œæˆ: $BACKUP_DIR"
```

### æ•°æ®éªŒè¯è„šæœ¬
```bash
#!/bin/bash
# validate-data.sh

echo "éªŒè¯æ•°æ®æ–‡ä»¶..."

# æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
if [ ! -f "data/stores.xlsx" ]; then
    echo "é”™è¯¯: stores.xlsx æ–‡ä»¶ä¸å­˜åœ¨"
    exit 1
fi

if [ ! -f "data/orders.xlsx" ]; then
    echo "é”™è¯¯: orders.xlsx æ–‡ä»¶ä¸å­˜åœ¨"
    exit 1
fi

# æ£€æŸ¥æ–‡ä»¶å¤§å°
if [ ! -s "data/stores.xlsx" ]; then
    echo "é”™è¯¯: stores.xlsx æ–‡ä»¶ä¸ºç©º"
    exit 1
fi

if [ ! -s "data/orders.xlsx" ]; then
    echo "é”™è¯¯: orders.xlsx æ–‡ä»¶ä¸ºç©º"
    exit 1
fi

echo "æ•°æ®æ–‡ä»¶éªŒè¯é€šè¿‡ï¼"
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœæ•°æ®æ›´æ–°é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`pm2 logs mcp-http-server`
2. æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå†…å®¹
3. è¿è¡Œæ•°æ®éªŒè¯è„šæœ¬
4. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

## ğŸ¯ æœ€ä½³å®è·µ

1. **å®šæœŸå¤‡ä»½**: æ›´æ–°æ•°æ®å‰å…ˆå¤‡ä»½
2. **æµ‹è¯•éªŒè¯**: æ›´æ–°åç«‹å³æµ‹è¯•åŠŸèƒ½
3. **ç‰ˆæœ¬æ§åˆ¶**: è®°å½•æ•°æ®æ›´æ–°å†å²
4. **ç›‘æ§å‘Šè­¦**: è®¾ç½®æ•°æ®å¼‚å¸¸å‘Šè­¦
5. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°æ•°æ®æ–‡æ¡£
